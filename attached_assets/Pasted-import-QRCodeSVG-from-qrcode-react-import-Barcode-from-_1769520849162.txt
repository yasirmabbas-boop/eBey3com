import { QRCodeSVG } from "qrcode.react";
import Barcode from "react-barcode";
import { Separator } from "@/components/ui/separator";

interface ShippingLabelProps {
  orderId: string;
  date: string;
  seller: {
    name: string;
    city: string;
    phone: string;
    address?: string;
  };
  buyer: {
    name: string;
    address: string;
    city: string;
    phone: string;
  };
  codAmount: number;
  productDescription: string;
  weight?: string;
}

export function ShippingLabel({ 
  orderId = "ORD-2026-001", 
  date = new Date().toISOString().split('T')[0], 
  seller = {
    name: "متجر الإلكترونيات",
    city: "الرياض",
    phone: "+966 50 123 4567"
  },
  buyer = {
    name: "أحمد محمد",
    address: "شارع الملك فهد، حي العليا",
    city: "جدة",
    phone: "+966 55 987 6543"
  },
  codAmount = 150.00, 
  productDescription = "سماعات بلوتوث لاسلكية",
  weight = "0.5 KG"
}: Partial<ShippingLabelProps>) {
  
  // Create a structured string for the QR code
  const qrData = JSON.stringify({ 
    id: orderId, 
    cod: codAmount, 
    d: date 
  });

  return (
    <div className="flex justify-center p-8 bg-gray-100 min-h-screen items-center">
      <div 
        className="w-[105mm] h-[148mm] bg-white text-black shadow-lg relative overflow-hidden flex flex-col"
        style={{ direction: "rtl", fontFamily: "'Segoe UI', Tahoma, 'Geneva', Verdana, sans-serif" }}
      >
        {/* Border Container */}
        <div className="absolute inset-2 border-2 border-black pointer-events-none" />

        <div className="p-4 h-full flex flex-col z-10">
          
          {/* Header Section */}
          <div className="flex justify-between items-start border-b-2 border-black pb-4 mb-4">
            <div className="text-right">
              <h1 className="text-2xl font-black text-black mb-1">إيصال توصيل</h1>
              <div className="text-sm font-bold text-gray-600 uppercase tracking-widest">SHIPPING LABEL</div>
            </div>
            <div className="flex flex-col items-end">
               <div className="border-2 border-black p-1 px-2 font-bold text-xl mb-1">
                 COD
               </div>
               <span className="text-xs font-bold">الدفع عند الاستلام</span>
            </div>
          </div>

          {/* Barcode Section */}
          <div className="flex justify-center mb-4 w-full overflow-hidden">
             <Barcode 
               value={orderId} 
               width={2} 
               height={50} 
               fontSize={14} 
               displayValue={true} 
               background="transparent"
             />
          </div>

          {/* Addresses Grid */}
          <div className="grid grid-